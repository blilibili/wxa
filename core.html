<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>@wxa | wxa-core</title>
    <meta name="description" content="wxa | 方便的小程序开发框架">
    <link rel="icon" href="/wxa/logo-mini.png">
    
    <link rel="preload" href="/wxa/assets/css/0.styles.ad190f40.css" as="style"><link rel="preload" href="/wxa/assets/js/app.64bb1321.js" as="script"><link rel="preload" href="/wxa/assets/js/16.51f1772b.js" as="script"><link rel="prefetch" href="/wxa/assets/js/8.cbe08453.js"><link rel="prefetch" href="/wxa/assets/js/vendors~docsearch.1d1ea3bb.js"><link rel="prefetch" href="/wxa/assets/js/2.17b18bdc.js"><link rel="prefetch" href="/wxa/assets/js/3.4906cfeb.js"><link rel="prefetch" href="/wxa/assets/js/4.50ba6720.js"><link rel="prefetch" href="/wxa/assets/js/5.3686a9af.js"><link rel="prefetch" href="/wxa/assets/js/6.3324a678.js"><link rel="prefetch" href="/wxa/assets/js/7.4d4d36c5.js"><link rel="prefetch" href="/wxa/assets/js/9.d374bca7.js"><link rel="prefetch" href="/wxa/assets/js/10.00615bc2.js"><link rel="prefetch" href="/wxa/assets/js/11.ba585c83.js"><link rel="prefetch" href="/wxa/assets/js/12.2a17b6a1.js"><link rel="prefetch" href="/wxa/assets/js/13.7f4b428c.js"><link rel="prefetch" href="/wxa/assets/js/14.5c70a1dc.js"><link rel="prefetch" href="/wxa/assets/js/15.4eb8cffd.js"><link rel="prefetch" href="/wxa/assets/js/17.e53b2661.js"><link rel="prefetch" href="/wxa/assets/js/18.c23f85f0.js">
    <link rel="stylesheet" href="/wxa/assets/css/0.styles.ad190f40.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/wxa/" class="home-link router-link-active"><!----><span class="site-name">
      @wxa
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/wxa/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/wxa/core.html" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="/wxa/cli.html" class="nav-link">命令行工具</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/wxa/core.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----><a href="/wxa/lang/english/core.html" class="nav-link">English</a></li></ul></div></div><a href="https://github.com/genuifx/wxa" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wxa/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/wxa/core.html" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="/wxa/cli.html" class="nav-link">命令行工具</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/wxa/core.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----><a href="/wxa/lang/english/core.html" class="nav-link">English</a></li></ul></div></div><a href="https://github.com/genuifx/wxa" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>wxa-core</span><!----></p><ul class="sidebar-group-items"><li><a href="/wxa/core.html#全局" class="sidebar-link">全局</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#setmaxrequest" class="sidebar-link">setMaxRequest</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#setrequestexpiredtime" class="sidebar-link">setRequestExpiredTime</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#addnopromiseapi" class="sidebar-link">addNoPromiseApi</a></li></ul></li><li><a href="/wxa/core.html#storage-api" class="sidebar-link">Storage API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#set" class="sidebar-link">set</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#get" class="sidebar-link">get</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#remove" class="sidebar-link">remove</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#clear" class="sidebar-link">clear</a></li></ul></li><li><a href="/wxa/core.html#wxapi" class="sidebar-link">Wxapi</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wxa/core.html#router" class="sidebar-link">Router</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#get-2" class="sidebar-link">get</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#getall" class="sidebar-link">getAll</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#push" class="sidebar-link">push</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#replace" class="sidebar-link">replace</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#relaunch" class="sidebar-link">reLaunch</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#switch" class="sidebar-link">switch</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#go" class="sidebar-link">go</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#goback" class="sidebar-link">goBack</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#close" class="sidebar-link">close</a></li></ul></li><li><a href="/wxa/core.html#eventbus" class="sidebar-link">Eventbus</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#on-name-handler" class="sidebar-link">on( name, handler )</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#off-name-handler" class="sidebar-link">off( name, handler )</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#emit-name" class="sidebar-link">emit( name )</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#clear-name" class="sidebar-link">clear( name )</a></li></ul></li><li><a href="/wxa/core.html#fetch" class="sidebar-link">Fetch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#fetch-2" class="sidebar-link">fetch</a></li></ul></li><li><a href="/wxa/core.html#utils" class="sidebar-link">Utils</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#formatdate" class="sidebar-link">formatDate</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#trim" class="sidebar-link">trim</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#compareversion" class="sidebar-link">compareVersion</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#debounce" class="sidebar-link">debounce</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#throttle" class="sidebar-link">throttle</a></li></ul></li><li><a href="/wxa/core.html#redux全局状态管理" class="sidebar-link">Redux全局状态管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#挂载" class="sidebar-link">挂载</a></li><li class="sidebar-sub-header"><a href="/wxa/core.html#映射" class="sidebar-link">映射</a></li></ul></li><li><a href="/wxa/core.html#插件" class="sidebar-link">插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wxa/core.html#插件示例" class="sidebar-link">插件示例</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="wxa-core"><a href="#wxa-core" aria-hidden="true" class="header-anchor">#</a> wxa-core</h1><p><img src="https://img.shields.io/badge/wxa-core-brightgreen.svg" alt></p><p><a href="https://travis-ci.org/Genuifx/wxa" target="_blank" rel="noopener noreferrer"><img src="https://travis-ci.org/Genuifx/wxa.svg?branch=master" alt="Build Status"></a><a href="https://www.npmjs.com/package/@wxa/core" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/v/@wxa/core.svg" alt="NPM version"></a><a href="https://codecov.io/gh/Genuifx/wxa" target="_blank" rel="noopener noreferrer"><img src="https://codecov.io/gh/Genuifx/wxa/branch/master/graph/badge.svg" alt="codecov"></a></p><p><code>@wxa/core</code>是一个非常小巧的包，用于增强小程序原生的能力。可以单独使用，但是一般推荐配合<a href="https://github.com/Genuifx/wxa-cli" target="_blank" rel="noopener noreferrer"><code>@wxa/cli</code></a>一起使用，体验更佳：）</p><p><code>@wxa/core</code>提供了下面几个Decorator，开发者可以选择性的引入，或者直接使用预定好的两个Decorator<code>@App</code>和<code>@Page</code></p><h2 id="全局"><a href="#全局" aria-hidden="true" class="header-anchor">#</a> 全局</h2><h3 id="setmaxrequest"><a href="#setmaxrequest" aria-hidden="true" class="header-anchor">#</a> setMaxRequest</h3><ul><li><strong>Type</strong>: <code>Function</code></li><li><strong>Default</strong>: <code>maxRequest = 5</code></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token comment">// app.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>wxa<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

wxa<span class="token punctuation">.</span><span class="token function">setMaxRequest</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...other logic</span>
</code></pre><p>设置最多同时并发的网络请求。</p><p>微信<code>wx.request</code>接口最多同时并发10个请求，超过10个请求将会被抛弃。wxa提供了一层request包装，引入队列控制并发请求。小程序业务层可以不关心并发多少个请求的问题，wxa将会保证每个请求都发出去。</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>最大并发请求不应该设置超过10<br>
超过最大并发的请求都会在队列等待其他请求完成后按顺序发出</p></div><h3 id="setrequestexpiredtime"><a href="#setrequestexpiredtime" aria-hidden="true" class="header-anchor">#</a> setRequestExpiredTime</h3><ul><li><strong>Type</strong>: <code>Function</code></li><li><strong>Default</strong>: <code>expiredTime=500ms</code></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token comment">// app.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>wxa<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

wxa<span class="token punctuation">.</span><span class="token function">setRequestExpiredTime</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...other logic</span>
</code></pre><p>设置post请求失效缓存失效时间。</p><p>使用wxa的<code>fetch</code>方法发送网络请求，wxa会缓存每个post请求，当客户端在一定时间内连续发送同一个请求的时候，wxa会主动reject并返回<code>{code: -101}</code>。相当于做一层前端post请求防重复。</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>wxa的前端防重机制大部分时间下可以很好的处理绝大多数请求重复的case。但是如果业务比较复杂，例如遇到多异步请求的事务性业务的时候，http层的请求防重并不能解决问题，wxa另外提供了一个<code>Lock</code>装饰器来处理这种情况。</p></div><h3 id="addnopromiseapi"><a href="#addnopromiseapi" aria-hidden="true" class="header-anchor">#</a> addNoPromiseApi</h3><ul><li><strong>Type</strong>: <code>Function</code></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>wxa<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

wxa<span class="token punctuation">.</span><span class="token function">addNoPromiseApi</span><span class="token punctuation">(</span><span class="token string">'getRecorderManager'</span><span class="token punctuation">)</span>

<span class="token comment">// ...other logic</span>
</code></pre><p>wxa尝试为所有<code>wx.**</code>的方法做一次promise化，但是有一些同步的api却不应该这么做，因为他们会直接返回某个句柄或者结果值，如果为他们做了promise化，这些返回将会被损失。</p><h2 id="storage-api"><a href="#storage-api" aria-hidden="true" class="header-anchor">#</a> Storage API</h2><p>storage方法包装了同步的wx.storage方法，提供简单，容易记得api</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>wxa提供了装饰器<code>Storage</code>和单独的<code>storage</code></p><p>Decorators:</p><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Storage<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

@Storage
<span class="token keyword">class</span> <span class="token class-name">Idx</span> <span class="token punctuation">{</span>
    methods <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> abc <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>直接使用:</p><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>storage<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> abc <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="set"><a href="#set" aria-hidden="true" class="header-anchor">#</a> set</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>set( key, value )</code></li></ul></li><li><strong>Arguments</strong> :
<ul><li><code>{String} key</code></li><li><code>{Any} value</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
</code></pre><p>同步保存数据到storage</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>storage并不能存<code>Function</code>类型的数据</p></div><h3 id="get"><a href="#get" aria-hidden="true" class="header-anchor">#</a> get</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>get( key )</code></li></ul></li><li><strong>Arguments</strong> :
<ul><li><code>{String} key</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
</code></pre><p>同步的获取数据</p><h3 id="remove"><a href="#remove" aria-hidden="true" class="header-anchor">#</a> remove</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>remove( key )</code></li></ul></li><li><strong>Arguments</strong> :
<ul><li><code>{String} key</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
</code></pre><p>清除指定key的数据</p><h3 id="clear"><a href="#clear" aria-hidden="true" class="header-anchor">#</a> clear</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>clear( )</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><p>清除所有的storage数据</p><h2 id="wxapi"><a href="#wxapi" aria-hidden="true" class="header-anchor">#</a> Wxapi</h2><p>包装了一层小程序的异步方法，使得开发者可以直接使用promise处理异步问题。
对于同步的方法，不做任何包装直接返回，示例如下：</p><ol><li>navigateToMiniProgram</li></ol><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>wxapi<span class="token punctuation">.</span><span class="token function">navigateToMiniProgram</span><span class="token punctuation">(</span><span class="token punctuation">{</span>params<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>succ<span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>fail<span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><ol start="2"><li>getSystemInfoSync</li></ol><pre class="language-javascript"><code><span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wxapi<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="warning custom-block"><p class="custom-block-title">注意</p><p>wxapi对所有微信api一次promise化。其中不会做promisify的方法有：<code>create*</code>方法，<code>*Sync</code>方法和<code>getUpdateManager</code>方法。</p><p>使用<code>wxa.addNoPromiseApi</code>可以手动添加方法，避免被方法被错误的promise化</p></div><h2 id="router"><a href="#router" aria-hidden="true" class="header-anchor">#</a> Router</h2><p>同<code>vue-router</code>的api风格，包装了一层小程序的跳转方法。</p><h3 id="get-2"><a href="#get-2" aria-hidden="true" class="header-anchor">#</a> get</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>get( )</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token comment">// {_webviewid: 1, route: 'pages/index/index', ...}</span>
<span class="token keyword">let</span> currentPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><p>获取当前路由页面信息</p><h3 id="getall"><a href="#getall" aria-hidden="true" class="header-anchor">#</a> getAll</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>getAll( )</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token comment">// [{...}, {...}, {...}]</span>
<span class="token keyword">let</span> stack <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>获取当前路由栈，相当于调用了小程序的<code>getCurrentPages()</code></p><h3 id="push"><a href="#push" aria-hidden="true" class="header-anchor">#</a> push</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>push( url )</code></li></ul></li><li><strong>Arguments</strong><ul><li><code>{String} url</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">'/pages/index'</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 跳转完成后做一些特殊处理</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>succ<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'isCutomer'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fail<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">'跳转失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>跳转到新路由页面,压栈路由</p><h3 id="replace"><a href="#replace" aria-hidden="true" class="header-anchor">#</a> replace</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>replace( url )</code></li></ul></li><li><strong>Arguments</strong><ul><li><code>{String} url</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">'/pages/index'</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>关闭当前页面，打开新的指定页面</p><h3 id="relaunch"><a href="#relaunch" aria-hidden="true" class="header-anchor">#</a> reLaunch</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>reLaunch( url )</code></li></ul></li><li><strong>Arguments</strong><ul><li><code>{String} url</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
</code></pre><p>关闭所有调用栈，重新打开指定页面</p><h3 id="switch"><a href="#switch" aria-hidden="true" class="header-anchor">#</a> switch</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>switch( url )</code></li></ul></li><li><strong>Arguments</strong><ul><li><code>{String} url</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token keyword">switch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>切换tabar页面</p><h3 id="go"><a href="#go" aria-hidden="true" class="header-anchor">#</a> go</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>go( delta )</code></li></ul></li><li><strong>Arguments</strong><ul><li><code>{Number} delta</code> 回退的页面数</li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>回退页面, key为欲回退页面数</p><h3 id="goback"><a href="#goback" aria-hidden="true" class="header-anchor">#</a> goBack</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>goBack( )</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">goBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>回退上一个页面，相当于调用<code>go(-1)</code>。</p><h3 id="close"><a href="#close" aria-hidden="true" class="header-anchor">#</a> close</h3><ul><li><strong>Pattern</strong>:
<ul><li><code>close( )</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>关闭小程序。⚠️谨慎调用，将会直接关闭小程序。</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p><code>router</code>提供的函数除了<code>get</code>, <code>getAll</code>之外都有返回一个promise的回调。</p></div><h2 id="eventbus"><a href="#eventbus" aria-hidden="true" class="header-anchor">#</a> Eventbus</h2><p>wxa提供了一个简易的自定义事件管理，允许用户跨页面，跨组件的共享信息。</p><h3 id="on-name-handler"><a href="#on-name-handler" aria-hidden="true" class="header-anchor">#</a> on( name, handler )</h3><ul><li><strong>arguments</strong><ul><li><code>{String} name</code></li><li><code>{Function} handler</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Eventbus
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token function">boo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'event'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">handler</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'event, handle here'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>监听一个自定义事件，当事件触发的时候执行回调队列。</p><h3 id="off-name-handler"><a href="#off-name-handler" aria-hidden="true" class="header-anchor">#</a> off( name, handler )</h3><ul><li><strong>arguments</strong><ul><li><code>{String} name</code></li><li><code>{Function} handler</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Eventbus
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token function">boo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'event'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">handler</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'event, handle here'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">'event'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>取消监听一个自定义事件</p><h3 id="emit-name"><a href="#emit-name" aria-hidden="true" class="header-anchor">#</a> emit( name )</h3><ul><li><strong>arguments</strong><ul><li><code>{String} name</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">)</span>
</code></pre><p>触发一个自定义事件</p><h3 id="clear-name"><a href="#clear-name" aria-hidden="true" class="header-anchor">#</a> clear( name )</h3><ul><li><strong>arguments</strong><ul><li><code>{String} name</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 注意这么写会清空所有事件</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>eventbus<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token string">'event'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清楚所有event事件监听</span>
</code></pre><p>清空指定事件回调，或者清空所有事件回调</p><h2 id="fetch"><a href="#fetch" aria-hidden="true" class="header-anchor">#</a> Fetch</h2><p><code>wxa</code>为网络请求提供了一个好用的<code>Fetch</code>装饰器，通过<code>fetch</code>，开发者可以快速的发起请求，而不需要担心<code>wx.request</code>引发的其他问题。</p><p><code>fetch</code>api具有promise化，队列化请求的能力，同时具备对<code>post</code>请求的短时间防重。</p><h3 id="fetch-2"><a href="#fetch-2" aria-hidden="true" class="header-anchor">#</a> fetch</h3><ul><li><strong>pattern</strong><ul><li><code>fetch( url, data, configs, methods )</code></li></ul></li><li><strong>arguments</strong><ul><li><code>{String} url</code></li><li><code>{Object} data</code> 请求携带的数据</li><li><code>{Object} configs</code> 请求的配置
<ul><li><code>{Boolean} $top</code> 高优先级请求，直接压入等待队列的列首</li><li><code>{Boolean} $noCache</code> 指定该请求不做防重处理</li><li><code>other</code> 其他小程序默认的配置都放在这里，例如header，dataType</li></ul></li><li><code>{String} methods</code> 请求方式, get, post</li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Fetch
<span class="token keyword">class</span> <span class="token class-name">UserInfo</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/remote/user/get'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>succ<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">// handle response here</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><h2 id="utils"><a href="#utils" aria-hidden="true" class="header-anchor">#</a> Utils</h2><p>常用的工具函数</p><h3 id="formatdate"><a href="#formatdate" aria-hidden="true" class="header-anchor">#</a> formatDate</h3><ul><li><strong>pattern</strong><ul><li><code>fetch( timestap, format )</code></li></ul></li><li><strong>arguments</strong><ul><li><code>{Number or String} timestap</code></li><li><code>{String} format</code> 格式化后的时间格式，默认<code>'yyyy-MM-dd hh:mm:ss'</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Utils
<span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> dateStr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">formateDate</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// .... other control</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>格式化时间戳为指定格式的字符串</p><h3 id="trim"><a href="#trim" aria-hidden="true" class="header-anchor">#</a> trim</h3><ul><li><strong>pattern</strong><ul><li><code>trim( str )</code></li></ul></li><li><strong>arguments</strong><ul><li><code>{String} str</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Utils
<span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        str <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// .... other control</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>由于小程序部分终端不支持<code>.trim</code>方法，所以wxa提供了一个补丁方法。</p><h3 id="compareversion"><a href="#compareversion" aria-hidden="true" class="header-anchor">#</a> compareVersion</h3><ul><li><strong>pattern</strong><ul><li><code>compareVersion( v1, v2 )</code></li></ul></li><li><strong>arguments</strong><ul><li><code>{String} v1</code></li><li><code>{String} v2</code></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Utils
<span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">compareVersion</span><span class="token punctuation">(</span><span class="token string">'1.2.1'</span><span class="token punctuation">,</span> <span class="token string">'1.1.0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
        
        <span class="token comment">// .... other control</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>小程序官方提供的基础库比较函数。</p><h3 id="debounce"><a href="#debounce" aria-hidden="true" class="header-anchor">#</a> debounce</h3><ul><li><strong>pattern</strong><ul><li><code>debounce( fn, [wait=0], [options={}] )</code></li></ul></li><li><strong>arguments</strong><ul><li><code>{Function} fn</code>  The function to debounce.</li><li><code>{Number} wait</code>  The number of milliseconds to delay.</li><li><code>{Object} options</code> The options object.
<ul><li><code>{Boolean} leading</code> Specify invoking on the leading edge of the timeout.</li><li><code>{Number} maxWait</code> The maximum time func is allowed to be delayed before it's invoked</li><li><code>{Boolean} trailing</code> Specify invoking on the trailing edge of the timeout.</li></ul></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Utils
<span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token function-variable function">release</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDone<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">debounce</span><span class="token punctuation">(</span>release<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
        
        <span class="token comment">// .... other control</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>debounce函数，详见<a href="https://lodash.com/docs/4.17.10#debounce" target="_blank" rel="noopener noreferrer"><code>lodash debounce</code></a>;</p><h3 id="throttle"><a href="#throttle" aria-hidden="true" class="header-anchor">#</a> throttle</h3><ul><li><strong>pattern</strong><ul><li><code>throttle( fn, [wait=0], [options={}] )</code></li></ul></li><li><strong>arguments</strong><ul><li><code>{Function} fn</code>  The function to throttle.</li><li><code>{Number} wait</code>  The number of milliseconds to delay.</li><li><code>{Object} options</code> The options object.
<ul><li><code>{Boolean} leading</code> Specify invoking on the leading edge of the timeout.</li><li><code>{Boolean} trailing</code> Specify invoking on the trailing edge of the timeout.</li></ul></li></ul></li><li><strong>Usage</strong>:</li></ul><pre class="language-js"><code>@Utils
<span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token function-variable function">release</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>isDone<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">throttle</span><span class="token punctuation">(</span>release<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
        
        <span class="token comment">// .... other control</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>throttle节流函数，详见<a href="https://lodash.com/docs/4.17.10#throttle" target="_blank" rel="noopener noreferrer"><code>lodash throttle</code></a>;</p><h2 id="redux全局状态管理"><a href="#redux全局状态管理" aria-hidden="true" class="header-anchor">#</a> Redux全局状态管理</h2><p><code>@wxa</code>提供了一个<a href="https://github.com/Genuifx/wxa-redux.git" target="_blank" rel="noopener noreferrer">redux</a>集成小程序方案，方便开发者管理全局应用状态</p><h3 id="挂载"><a href="#挂载" aria-hidden="true" class="header-anchor">#</a> 挂载</h3><p>要使用<code>@wxa/redux</code>首先需要挂载插件到wxa。</p><pre class="language-javascript"><code><span class="token comment">// app.wxa or app.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>wxa<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>wxaRedux<span class="token punctuation">,</span> combineReducers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/redux'</span>
<span class="token keyword">import</span> promiseMiddleware <span class="token keyword">from</span> <span class="token string">'redux-promise'</span><span class="token punctuation">;</span>

wxa<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>wxaRedux<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    reducers<span class="token punctuation">:</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token operator">...</span>your reducer<span class="token punctuation">)</span><span class="token punctuation">,</span>
    middlewares<span class="token punctuation">:</span> <span class="token punctuation">[</span>promiseMiddleware<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>挂载完毕后，wxa会在所有调用<code>launchApp</code>,<code>launchPage</code>和<code>launchComponent</code>的地方自动connect store到相应示例。</p><h3 id="映射"><a href="#映射" aria-hidden="true" class="header-anchor">#</a> 映射</h3><p><code>@wxa/redux</code>并不会把所有reducer都映射到实例，只有在实例中指定了的reducer才能自动从store同步。</p><h4 id="映射到page"><a href="#映射到page" aria-hidden="true" class="header-anchor">#</a> 映射到Page</h4><pre class="language-javascript"><code><span class="token comment">// page.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Page<span class="token punctuation">,</span> wxa<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

@Page
<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token punctuation">{</span>
    mapState <span class="token operator">=</span> <span class="token punctuation">{</span>
        todolist <span class="token punctuation">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token operator">=&gt;</span>state<span class="token punctuation">.</span>todo
    <span class="token punctuation">}</span>
    methods <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">bindtap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// dispatch your commit here</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'Add_todo_list'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token string">'coding today'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// and your page data will auto update.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 

wxa<span class="token punctuation">.</span><span class="token function">launchPage</span><span class="token punctuation">(</span>Index<span class="token punctuation">)</span>

</code></pre><h4 id="映射到component"><a href="#映射到component" aria-hidden="true" class="header-anchor">#</a> 映射到Component</h4><pre class="language-javascript"><code><span class="token comment">// component.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>GetApp<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@wxa/core'</span>

<span class="token comment">// redux need mount app to com.</span>
@GetApp
<span class="token keyword">class</span> <span class="token class-name">Com</span> <span class="token punctuation">{</span>
    mapState <span class="token operator">=</span> <span class="token punctuation">{</span>
        todolist <span class="token punctuation">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token operator">=&gt;</span>state<span class="token punctuation">.</span>todo
    <span class="token punctuation">}</span>
    methods <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">bindtap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// dispatch your commit here</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'Add_todo_list'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token string">'coding today'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// and your page data will auto update.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 

wxa<span class="token punctuation">.</span><span class="token function">launchComponent</span><span class="token punctuation">(</span>Com<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>具体的实现细节可以参考<a href="https://github.com/Genuifx/wxa-redux.git" target="_blank" rel="noopener noreferrer">@wxa/redux</a></p><h2 id="插件"><a href="#插件" aria-hidden="true" class="header-anchor">#</a> 插件</h2><p>wxa在调用<code>launchApp</code>,<code>launchPage</code>和<code>launchComponent</code>生成实例的时候会自动应用每个注册的插件，插件机制允许开发者为wxa开发新的功能。</p><h3 id="插件示例"><a href="#插件示例" aria-hidden="true" class="header-anchor">#</a> 插件示例</h3><pre class="language-javascript"><code><span class="token comment">// somthing report error message to remote server</span>
<span class="token keyword">import</span> wa <span class="token keyword">from</span> <span class="token string">'wa'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>vm<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'App'</span><span class="token punctuation">,</span> <span class="token string">'Page'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            vm<span class="token punctuation">.</span>logger <span class="token operator">=</span> wa<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>插件将拿到当前实例<code>vm</code>, 以及实例的类型<code>App</code>，<code>Page</code>，<code>Component</code>。</p></div><div class="content edit-link"><a href="https://github.com/genuifx/wxa/edit/master/docs/core.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div></div></div>
    <script src="/wxa/assets/js/16.51f1772b.js" defer></script><script src="/wxa/assets/js/app.64bb1321.js" defer></script>
  </body>
</html>
